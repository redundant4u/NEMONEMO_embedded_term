#include "game.h"
#include "lcd.h"

extern int stageNumber;
extern int boardState[BOARD_ROW_SIZE][BOARD_ROW_SIZE];

// 네모네모로직 문제 변수 - 정답, 문제(위), 문제(왼쪽)
const Game game[6] = {
    {
        // 1. korea
        {
            {0,0,0,1,0, 0,0,1,1,1},
            {0,0,1,0,0, 0,0,0,1,1},
            {0,1,1,0,0, 1,0,0,0,1},
            {1,1,1,0,0, 0,0,0,0,0},
            {1,1,1,1,0, 0,0,0,0,0},
            {1,1,1,1,1, 1,0,0,0,0},
            {1,1,1,1,1, 1,1,0,0,0},
            {0,1,1,1,0, 1,1,0,0,1},
            {0,0,1,1,1, 1,1,0,1,1},
            {0,0,0,1,1, 1,0,1,1,1}
        },
        {
            {0, 0, 4},
            {0, 0, 6},
            {0, 0, 8},
            {0, 1, 6},
            {0, 2, 2},
            {0, 1, 5},
            {0, 0, 3},
            {0, 1, 1},
            {0, 2, 2},
            {0, 3, 3}
        },
        {
            {0, 1, 3},
            {0, 1, 2},
            {2, 1, 1},
            {0, 0, 3},
            {0, 0, 4},
            {0, 0, 6},
            {0, 0, 7},
            {3, 2, 1},
            {0, 5, 2},
            {0, 3, 3}
        }
    },
    {
        // 2.cherry
        {
            {0,0,0,0,0, 0,1,1,1,1},
            {0,0,0,0,0, 1,1,0,0,1},
            {0,0,0,0,1, 0,1,1,0,0},
            {0,0,0,1,1, 0,0,1,0,0},
            {0,0,1,0,0, 0,0,1,0,0},
            {0,1,1,1,0, 0,1,1,1,0},
            {1,0,0,1,1, 1,0,0,1,1},
            {1,0,1,1,1, 1,0,1,1,1},
            {1,1,1,1,0, 1,1,1,1,1},
            {0,1,1,0,0, 0,1,1,1,0}

        },
        {
            {0,0,3},
            {0,1,2},
            {0,2,3},
            {0,1,4},
            {0,2,2},
            {0,1,3},
            {3,1,2},
            {1,4,3}, 
            {0,1,5},
            {0,2,3}
        },
        {
            {0,0,4},
            {0,2,1},
            {0,1,2},
            {0,2,1},
            {0,1,1},
            {0,3,3},
            {1,3,2},
            {1,4,3}, 
            {0,4,5},
            {0,2,3}
        }
    },
    {
        //3. black cat
        {
            {0,0,1,0,1, 0,0,0,0,0},
            {0,1,1,1,1, 0,0,0,0,0},
            {1,0,1,1,1, 0,0,0,1,0},
            {1,1,1,1,1, 0,0,1,0,0},
            {0,1,1,1,0, 0,0,1,1,0},
            {0,0,1,1,1, 1,0,0,1,1},
            {0,0,1,1,1, 1,1,0,0,1},
            {0,1,1,1,1, 1,1,0,0,1},
            {0,1,1,0,1, 1,1,0,1,1},
            {1,1,0,1,1, 1,1,1,1,0}
        },
        {
            {0,2,1},
            {1,2,3},
            {0,0,9},
            {0,7,1},
            {0,4,5},
            {0,0,5},
            {0,0,4},
            {0,2,1},
            {1,2,2},
            {0,0,4}
        },
        {
            {0,1,1},
            {0,0,4},
            {1,3,1},
            {0,5,1},
            {0,3,2},
            {0,4,2},
            {0,5,1},
            {0,6,1},
            {2,3,2},
            {0,2,6}
        },
    },
    {
        //4. moon and star
        {
            {0,0,0,1,1, 1,0,0,1,0},
            {0,1,1,1,1, 0,0,1,1,1},
            {1,1,1,1,0, 0,0,0,1,0},
            {1,1,1,0,0, 1,0,0,0,0},
            {1,1,1,0,1, 1,1,0,0,0},
            {1,1,1,0,0, 1,0,0,0,1},
            {1,1,1,1,0, 0,0,0,1,1},
            {1,1,1,1,1, 1,1,1,1,1},
            {0,1,1,1,1, 1,1,1,1,0},
            {0,0,1,1,1, 1,1,1,0,0}
        },
        {
            {0,0,6},
            {0,0,8},
            {0,0,9},
            {0,3,4},
            {2,1,3},
            {1,3,3},
            {0,1,3},
            {0,1,3},
            {0,3,3},
            {0,1,3}
        },
        {
            {0,3,1},
            {0,4,3},
            {0,4,1},
            {0,3,1},
            {0,3,3},
            {3,1,1},
            {0,4,2},
            {0,0,10},
            {0,0,8},
            {0,0,6}
        }
    },
    {
        //5. cat report
        {
            {1,1,1,1,1, 1,1,1,0,0},
            {1,0,1,1,1, 1,1,1,1,0},
            {1,0,1,1,1, 1,1,1,1,0},
            {1,0,1,1,1, 1,1,1,1,1},
            {1,0,0,1,1, 0,1,1,1,1},
            {1,0,0,0,0, 0,1,1,1,1},
            {1,1,0,1,0, 1,1,1,1,1},
            {0,0,0,1,1, 1,1,1,1,1},
            {0,1,1,0,1, 0,1,1,1,0},
            {1,1,0,1,1, 1,1,0,1,0}
        },
        {
            {0,7,1},
            {1,1,2},
            {0,4,1},
            {5,2,1},
            {0,5,3},
            {4,2,1},
            {0,0,10},
            {0,0,9},
            {0,0,9},
            {0,0,5}
        },
        {
            {0,0,8},
            {0,1,7},
            {0,1,7},
            {0,1,8},
            {1,2,4},
            {0,1,4},
            {2,1,5},
            {0,0,7},
            {2,1,3},
            {2,4,1}
        }
    },
    {
        //6. puppy
        {
            {1,1,1,0,0, 0,0,1,1,1},
            {1,0,1,1,1, 1,1,1,0,1},
            {0,0,1,1,1, 1,1,1,0,0},
            {0,0,1,0,1, 1,0,1,0,0},
            {0,0,1,1,1, 1,1,1,0,0},
            {0,0,1,1,0, 1,1,1,0,0},
            {0,0,1,1,1, 1,1,1,1,0},
            {0,0,0,1,1, 1,1,0,1,1},
            {0,0,0,0,1, 0,0,1,1,1},
            {0,0,0,0,1, 1,1,1,1,1}
        },
        {
            {0,0,2},
            {0,0,1},
            {0,0,7},
            {0,2,4},
            {0,4,4},
            {0,7,1},
            {2,4,1},
            {0,7,2},
            {0,1,4},
            {0,2,3}
        },
        {
            {0,3,3},
            {1,6,1},
            {0,0,6},
            {1,2,1},
            {0,0,6},
            {0,2,3},
            {0,0,7},
            {0,4,2},
            {0,1,3},
            {0,0,6}
        }
    }
};

// gameScreen 보드 그리기 함수
void drawBoard(void)
{
    for (int i = START_X; i < BOARD_END_X; i += BOARD_UNIT)
    {
        for (int j = START_Y; j < BOARD_END_Y; j += BOARD_UNIT)
        {
            LCD_DrawRectangle(i, j, i + BOARD_UNIT, j + BOARD_UNIT);
        }
    }
}

// gameScreen 문제 그리기 함수
void drawProblem(void)
{
    // 문제(위) 그리기
    for (int x = 0; x < PROBLEM_MAX_X; x++)
    {
        for (int y = 0; y < PROBLEM_MAX_Y; y++)
        {
            if (game[stageNumber].problem_up[x][y] != 0)
                LCD_ShowNum(
                    START_X + PROBLEM_UP_PADDING + (BOARD_UNIT * x),
                    START_Y - (BOARD_UNIT * 3) + (BOARD_UNIT * y),
                    game[stageNumber].problem_up[x][y], 1, BLACK, WHITE);
        }
    }

    // 문제(왼쪽) 그리기
    for (int x = 0; x < PROBLEM_MAX_X; x++)
    {
        for (int y = 0; y < PROBLEM_MAX_Y; y++)
        {
            if (game[stageNumber].problem_left[x][y] != 0)
                LCD_ShowNum(START_X - PROBLEM_LEFT_PADDING + (BOARD_UNIT * y),
                            START_Y + (BOARD_UNIT * x),
                            game[stageNumber].problem_left[x][y], 1, BLACK, WHITE);
        }
    }
}

// 문제 정답과 비교하여 완성률을 산출하는 함수
int checkCorrect(void)
{
    int correctCount = 0;
    for (int i = 0; i < BOARD_ROW_SIZE; i++)
    {
        for (int j = 0; j < BOARD_ROW_SIZE; j++)
        {
            if (boardState[i][j] == game[stageNumber].correct[i][j])
                correctCount++;
        }
    }
    return correctCount;
}